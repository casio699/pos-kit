import{b as se,c as ae,r,j as e}from"./index-DFD28I4s.js";import{L as re}from"./LoadingSpinner-mVzqVygt.js";import{a as le,b as ne,f as oe,g as de}from"./client-C7ulCTuc.js";import{R as w,L as ie,C as T,X as W,Y as V,T as k,a as H,b as R,P as ce,c as xe,d as me,B as he,e as $}from"./PieChart-emmdGlN8.js";function ye(){const{tenantId:m}=se(),{isAdmin:C}=ae(),[v,h]=r.useState(!1),[S,u]=r.useState(null),[d,E]=r.useState(""),[g,I]=r.useState("all"),[p,z]=r.useState("all"),[N,K]=r.useState("table"),[L,M]=r.useState(!1),[U,G]=r.useState([]),[i,Q]=r.useState([]),[X,Y]=r.useState([]),[j,P]=r.useState(""),[b,_]=r.useState(""),[y,q]=r.useState(1),[f,B]=r.useState(50),[A,O]=r.useState("card"),J=[{date:"Mon",sales:1200,revenue:4800},{date:"Tue",sales:1800,revenue:7200},{date:"Wed",sales:1500,revenue:6e3},{date:"Thu",sales:2200,revenue:8800},{date:"Fri",sales:2800,revenue:11200},{date:"Sat",sales:3200,revenue:12800},{date:"Sun",sales:2100,revenue:8400}],D=[{name:"Credit Card",value:65,color:"#3B82F6"},{name:"Cash",value:20,color:"#10B981"},{name:"Mobile",value:10,color:"#F59E0B"},{name:"Other",value:5,color:"#EF4444"}],Z=[{name:"Product A",sales:45,revenue:2250},{name:"Product B",sales:38,revenue:1900},{name:"Product C",sales:32,revenue:1600},{name:"Product D",sales:28,revenue:1400},{name:"Product E",sales:22,revenue:1100}],F=async()=>{var t,s;h(!0),u(null);try{const[a,n,x]=await Promise.all([le(m),ne(m).catch(()=>[]),oe(m).catch(()=>[])]);G(a),Q(n),Y(x),a[0]&&!j&&P(a[0].id),n[0]&&!b&&_(n[0].id),a[0]&&a[0].price&&typeof a[0].price=="string"&&B(parseFloat(a[0].price))}catch(a){u(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||a.message)}finally{h(!1)}};r.useEffect(()=>{F()},[]);const ee=async()=>{var t,s;if(!(!j||!b)){h(!0),u(null);try{const a=f*y;await de(m,{location_id:b,lines:[{product_id:j,quantity:y,unit_price:f,discount:0}],total_amount:a,payment_method:A}),await F()}catch(a){u(((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||a.message)}finally{h(!1)}}},l=X.filter(t=>{const s=i.find(o=>o.id===t.location_id),a=!d||t.id.toLowerCase().includes(d.toLowerCase())||(s==null?void 0:s.name.toLowerCase().includes(d.toLowerCase()))||t.payment_method.toLowerCase().includes(d.toLowerCase()),n=g==="all"||t.location_id===g,x=p==="all"||t.payment_method===p;return a&&n&&x}),c=(()=>{const t=l.length,s=l.reduce((o,te)=>o+parseFloat(te.total_amount.toString()),0),a=t>0?s/t:0,n=l.filter(o=>o.payment_method==="card").length,x=l.filter(o=>o.payment_method==="cash").length;return{totalSales:t,totalRevenue:s,avgSaleAmount:a,cardSales:n,cashSales:x}})();return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-2",children:"Sales Management"}),e.jsx("p",{className:"text-purple-100",children:"Track and manage all your sales transactions"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>K(N==="table"?"cards":"table"),className:"px-4 py-2 bg-white/20 backdrop-blur rounded-lg hover:bg-white/30 transition-colors text-white font-medium",children:N==="table"?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),C()&&e.jsxs("button",{onClick:()=>M(!L),className:"px-4 py-2 bg-white text-purple-600 rounded-lg hover:bg-purple-50 font-medium transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"New Sale"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Total"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:c.totalSales}),e.jsx("div",{className:"text-sm text-gray-600",children:"Sales"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsx("span",{className:"text-xs text-green-500 font-medium",children:"Revenue"})]}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["$",c.totalRevenue.toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Revenue"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})})}),e.jsx("span",{className:"text-xs text-blue-500 font-medium",children:"Average"})]}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["$",c.avgSaleAmount.toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Sale"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsx("span",{className:"text-xs text-yellow-500 font-medium",children:"Card"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:c.cardSales}),e.jsx("div",{className:"text-sm text-gray-600",children:"Card Sales"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("span",{className:"text-xs text-indigo-500 font-medium",children:"Cash"})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:c.cashSales}),e.jsx("div",{className:"text-sm text-gray-600",children:"Cash Sales"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Weekly Sales Trend"}),e.jsx(w,{width:"100%",height:300,children:e.jsxs(ie,{data:J,children:[e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"date"}),e.jsx(V,{}),e.jsx(k,{}),e.jsx(H,{}),e.jsx(R,{type:"monotone",dataKey:"sales",stroke:"#8B5CF6",strokeWidth:2}),e.jsx(R,{type:"monotone",dataKey:"revenue",stroke:"#10B981",strokeWidth:2})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment Methods"}),e.jsx(w,{width:"100%",height:300,children:e.jsxs(ce,{children:[e.jsx(xe,{data:D,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:s})=>`${t} ${((s||0)*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:D.map((t,s)=>e.jsx(me,{fill:t.color},`cell-${s}`))}),e.jsx(k,{})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Selling Products"}),e.jsx(w,{width:"100%",height:300,children:e.jsxs(he,{data:Z,children:[e.jsx(T,{strokeDasharray:"3 3"}),e.jsx(W,{dataKey:"name"}),e.jsx(V,{}),e.jsx(k,{}),e.jsx(H,{}),e.jsx($,{dataKey:"sales",fill:"#8B5CF6"}),e.jsx($,{dataKey:"revenue",fill:"#10B981"})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Search sales by ID, location, or payment method...",value:d,onChange:t=>E(t.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("select",{value:g,onChange:t=>I(t.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Locations"}),i.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:p,onChange:t=>z(t.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Payment Methods"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"cash",children:"Cash"})]}),e.jsx("button",{className:"px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-medium transition-colors",children:"Export Sales"})]})}),L&&C()&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl shadow-lg p-6 border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create New Sale"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 mb-4",children:[e.jsx("select",{className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",value:j,onChange:t=>P(t.target.value),children:U.map(t=>e.jsxs("option",{value:t.id,children:[t.sku," â€” ",t.name]},t.id))}),e.jsx("select",{className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",value:b,onChange:t=>_(t.target.value),children:i.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))}),e.jsx("input",{type:"number",className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",value:y,onChange:t=>q(parseInt(t.target.value||"0",10)),placeholder:"Quantity"}),e.jsx("input",{type:"number",className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",value:f,onChange:t=>B(parseFloat(t.target.value||"0")),placeholder:"Unit Price"}),e.jsxs("select",{className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",value:A,onChange:t=>O(t.target.value),children:[e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"cash",children:"Cash"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["Total: $",(f*y).toFixed(2)]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>M(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:ee,disabled:v,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-medium transition-colors disabled:opacity-50",children:v?"Processing...":"Complete Sale"})]})]}),S&&e.jsx("div",{className:"mt-3 text-sm text-red-600",children:S})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:v?e.jsx(re,{message:"Loading sales..."}):l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sales found"}),e.jsx("p",{className:"text-gray-500",children:d||g!=="all"||p!=="all"?"Try adjusting your search or filters to find what you're looking for.":"Get started by creating your first sale."})]}):N==="table"?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"py-4 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sale ID"}),e.jsx("th",{className:"py-4 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),e.jsx("th",{className:"py-4 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"py-4 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Method"}),e.jsx("th",{className:"py-4 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden lg:table-cell",children:"Date"}),e.jsx("th",{className:"py-4 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:l.map(t=>{const s=i.find(a=>a.id===t.location_id);return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.id})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:"text-sm text-gray-900",children:(s==null?void 0:s.name)||"Unknown"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["$",typeof t.total_amount=="string"?t.total_amount:t.total_amount.toFixed(2)]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.payment_method==="card"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:t.payment_method==="card"?"Card":"Cash"})}),e.jsx("td",{className:"py-4 px-4 hidden lg:table-cell text-xs text-gray-500",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-purple-600 hover:text-purple-800 text-sm font-medium",children:"View Details"}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Receipt"})]})})]},t.id)})})]})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:l.map(t=>{const s=i.find(a=>a.id===t.location_id);return e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center text-white font-bold",children:t.id.charAt(0).toUpperCase()}),e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.payment_method==="card"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:t.payment_method==="card"?"Card":"Cash"})]}),e.jsxs("h3",{className:"font-semibold text-gray-900 mb-1",children:["Sale #",t.id]}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:(s==null?void 0:s.name)||"Unknown Location"}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["$",typeof t.total_amount=="string"?t.total_amount:t.total_amount.toFixed(2)]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"flex-1 px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700",children:"Details"}),e.jsx("button",{className:"flex-1 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:"Receipt"})]})]})},t.id)})})})]})}export{ye as default};
